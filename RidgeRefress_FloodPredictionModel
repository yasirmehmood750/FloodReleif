{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/yasirmehmood2/ridgeregress-floodprediction?scriptVersionId=179649260\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"code","execution_count":1,"id":"3676bb33","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:40.976233Z","iopub.status.busy":"2024-05-25T06:33:40.975805Z","iopub.status.idle":"2024-05-25T06:33:43.428413Z","shell.execute_reply":"2024-05-25T06:33:43.427453Z"},"papermill":{"duration":2.462413,"end_time":"2024-05-25T06:33:43.430992","exception":false,"start_time":"2024-05-25T06:33:40.968579","status":"completed"},"tags":[]},"outputs":[],"source":["import pandas as pd\n","import numpy as np\n","\n","from sklearn.metrics import accuracy_score\n","\n","from sklearn.model_selection import train_test_split\n","from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score\n","\n","import matplotlib.pyplot as plt\n","\n","from sklearn.preprocessing import PolynomialFeatures\n","from sklearn.metrics import mean_squared_error, r2_score\n","\n"]},{"cell_type":"code","execution_count":2,"id":"6b38b609","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:43.442765Z","iopub.status.busy":"2024-05-25T06:33:43.44155Z","iopub.status.idle":"2024-05-25T06:33:46.34323Z","shell.execute_reply":"2024-05-25T06:33:46.341859Z"},"papermill":{"duration":2.910656,"end_time":"2024-05-25T06:33:46.346464","exception":false,"start_time":"2024-05-25T06:33:43.435808","status":"completed"},"tags":[]},"outputs":[],"source":["# importing CSV with training data\n","file_path = '/kaggle/input/flood-regression-dataset/train.csv'\n","    # Read the CSV file into a DataFrame\n","df = pd.read_csv(file_path)\n","\n","X=df.copy()\n","\n","X.drop(columns=['FloodProbability'],inplace=True)\n","\n","y=df[['FloodProbability']]"]},{"cell_type":"code","execution_count":3,"id":"bebc0099","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:46.357455Z","iopub.status.busy":"2024-05-25T06:33:46.357032Z","iopub.status.idle":"2024-05-25T06:33:46.650337Z","shell.execute_reply":"2024-05-25T06:33:46.649189Z"},"papermill":{"duration":0.302487,"end_time":"2024-05-25T06:33:46.653669","exception":false,"start_time":"2024-05-25T06:33:46.351182","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>MonsoonIntensity</th>\n","      <th>TopographyDrainage</th>\n","      <th>RiverManagement</th>\n","      <th>Deforestation</th>\n","      <th>Urbanization</th>\n","      <th>ClimateChange</th>\n","      <th>DamsQuality</th>\n","      <th>Siltation</th>\n","      <th>AgriculturalPractices</th>\n","      <th>...</th>\n","      <th>DrainageSystems</th>\n","      <th>CoastalVulnerability</th>\n","      <th>Landslides</th>\n","      <th>Watersheds</th>\n","      <th>DeterioratingInfrastructure</th>\n","      <th>PopulationScore</th>\n","      <th>WetlandLoss</th>\n","      <th>InadequatePlanning</th>\n","      <th>PoliticalFactors</th>\n","      <th>FloodProbability</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>0</th>\n","      <td>0</td>\n","      <td>5</td>\n","      <td>8</td>\n","      <td>5</td>\n","      <td>8</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>...</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>0.445</td>\n","    </tr>\n","    <tr>\n","      <th>1</th>\n","      <td>1</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>8</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>...</td>\n","      <td>7</td>\n","      <td>2</td>\n","      <td>0</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>0.450</td>\n","    </tr>\n","    <tr>\n","      <th>2</th>\n","      <td>2</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>1</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>...</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>8</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>0.530</td>\n","    </tr>\n","    <tr>\n","      <th>3</th>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>...</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>0.535</td>\n","    </tr>\n","    <tr>\n","      <th>4</th>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>...</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>0.415</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>1117952</th>\n","      <td>1117952</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>10</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>7</td>\n","      <td>10</td>\n","      <td>...</td>\n","      <td>7</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>1</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>0.495</td>\n","    </tr>\n","    <tr>\n","      <th>1117953</th>\n","      <td>1117953</td>\n","      <td>2</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>9</td>\n","      <td>5</td>\n","      <td>8</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>...</td>\n","      <td>9</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>4</td>\n","      <td>9</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>0.480</td>\n","    </tr>\n","    <tr>\n","      <th>1117954</th>\n","      <td>1117954</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>9</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>9</td>\n","      <td>1</td>\n","      <td>3</td>\n","      <td>...</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>0.485</td>\n","    </tr>\n","    <tr>\n","      <th>1117955</th>\n","      <td>1117955</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>...</td>\n","      <td>6</td>\n","      <td>8</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>0.495</td>\n","    </tr>\n","    <tr>\n","      <th>1117956</th>\n","      <td>1117956</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>9</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>8</td>\n","      <td>4</td>\n","      <td>...</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>7</td>\n","      <td>8</td>\n","      <td>0.560</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>1117957 rows × 22 columns</p>\n","</div>"],"text/plain":["              id  MonsoonIntensity  TopographyDrainage  RiverManagement  \\\n","0              0                 5                   8                5   \n","1              1                 6                   7                4   \n","2              2                 6                   5                6   \n","3              3                 3                   4                6   \n","4              4                 5                   3                2   \n","...          ...               ...                 ...              ...   \n","1117952  1117952                 3                   3                4   \n","1117953  1117953                 2                   2                4   \n","1117954  1117954                 7                   3                9   \n","1117955  1117955                 7                   3                3   \n","1117956  1117956                 4                   5                6   \n","\n","         Deforestation  Urbanization  ClimateChange  DamsQuality  Siltation  \\\n","0                    8             6              4            4          3   \n","1                    4             8              8            3          5   \n","2                    7             3              7            1          5   \n","3                    5             4              8            4          7   \n","4                    6             4              4            3          3   \n","...                ...           ...            ...          ...        ...   \n","1117952             10             4              5            5          7   \n","1117953              3             9              5            8          1   \n","1117954              4             6              5            9          1   \n","1117955              7             5              2            3          4   \n","1117956              9             5              5            2          8   \n","\n","         AgriculturalPractices  ...  DrainageSystems  CoastalVulnerability  \\\n","0                            3  ...                5                     3   \n","1                            4  ...                7                     2   \n","2                            4  ...                7                     3   \n","3                            6  ...                2                     4   \n","4                            3  ...                2                     2   \n","...                        ...  ...              ...                   ...   \n","1117952                     10  ...                7                     8   \n","1117953                      3  ...                9                     4   \n","1117954                      3  ...                5                     5   \n","1117955                      6  ...                6                     8   \n","1117956                      4  ...                4                     8   \n","\n","         Landslides  Watersheds  DeterioratingInfrastructure  PopulationScore  \\\n","0                 3           5                            4                7   \n","1                 0           3                            5                3   \n","2                 7           5                            6                8   \n","3                 7           4                            4                6   \n","4                 6           6                            4                1   \n","...             ...         ...                          ...              ...   \n","1117952           7           2                            2                1   \n","1117953           4           3                            7                4   \n","1117954           5           5                            6                5   \n","1117955           5           3                            4                6   \n","1117956           6           5                            5                6   \n","\n","         WetlandLoss  InadequatePlanning  PoliticalFactors  FloodProbability  \n","0                  5                   7                 3             0.445  \n","1                  3                   4                 3             0.450  \n","2                  2                   3                 3             0.530  \n","3                  5                   7                 5             0.535  \n","4                  2                   3                 5             0.415  \n","...              ...                 ...               ...               ...  \n","1117952            4                   6                 4             0.495  \n","1117953            9                   4                 5             0.480  \n","1117954            5                   2                 4             0.485  \n","1117955            7                   6                 4             0.495  \n","1117956            7                   7                 8             0.560  \n","\n","[1117957 rows x 22 columns]"]},"execution_count":3,"metadata":{},"output_type":"execute_result"}],"source":["df"]},{"cell_type":"code","execution_count":4,"id":"9a533e87","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:46.666946Z","iopub.status.busy":"2024-05-25T06:33:46.66648Z","iopub.status.idle":"2024-05-25T06:33:47.069739Z","shell.execute_reply":"2024-05-25T06:33:47.068129Z"},"papermill":{"duration":0.413971,"end_time":"2024-05-25T06:33:47.073325","exception":false,"start_time":"2024-05-25T06:33:46.659354","status":"completed"},"tags":[]},"outputs":[],"source":["#splitting the data into training data and test data ( aorund 20% of data will be used for testing the results whereas 80% for training the model)\n","\n","#X_train contains training data\n","# y_train cotains result set for training data  ( both X_train and y_train will train the model)\n","# X_test contains the test data\n","# y_test contains test expected Results\n","#X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)\n","X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2)\n","\n","X_train_original=X_train\n","X_test_original=X_test\n","y_train_original=y_train\n","y_test_original=y_test"]},{"cell_type":"code","execution_count":5,"id":"6867909e","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.088401Z","iopub.status.busy":"2024-05-25T06:33:47.087439Z","iopub.status.idle":"2024-05-25T06:33:47.20232Z","shell.execute_reply":"2024-05-25T06:33:47.201039Z"},"papermill":{"duration":0.124621,"end_time":"2024-05-25T06:33:47.204991","exception":false,"start_time":"2024-05-25T06:33:47.08037","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<div>\n","<style scoped>\n","    .dataframe tbody tr th:only-of-type {\n","        vertical-align: middle;\n","    }\n","\n","    .dataframe tbody tr th {\n","        vertical-align: top;\n","    }\n","\n","    .dataframe thead th {\n","        text-align: right;\n","    }\n","</style>\n","<table border=\"1\" class=\"dataframe\">\n","  <thead>\n","    <tr style=\"text-align: right;\">\n","      <th></th>\n","      <th>id</th>\n","      <th>MonsoonIntensity</th>\n","      <th>TopographyDrainage</th>\n","      <th>RiverManagement</th>\n","      <th>Deforestation</th>\n","      <th>Urbanization</th>\n","      <th>ClimateChange</th>\n","      <th>DamsQuality</th>\n","      <th>Siltation</th>\n","      <th>AgriculturalPractices</th>\n","      <th>...</th>\n","      <th>IneffectiveDisasterPreparedness</th>\n","      <th>DrainageSystems</th>\n","      <th>CoastalVulnerability</th>\n","      <th>Landslides</th>\n","      <th>Watersheds</th>\n","      <th>DeterioratingInfrastructure</th>\n","      <th>PopulationScore</th>\n","      <th>WetlandLoss</th>\n","      <th>InadequatePlanning</th>\n","      <th>PoliticalFactors</th>\n","    </tr>\n","  </thead>\n","  <tbody>\n","    <tr>\n","      <th>756240</th>\n","      <td>756240</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>...</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>5</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>902933</th>\n","      <td>902933</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>6</td>\n","      <td>9</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>...</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>7</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>393485</th>\n","      <td>393485</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>...</td>\n","      <td>8</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>8</td>\n","      <td>5</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>809673</th>\n","      <td>809673</td>\n","      <td>2</td>\n","      <td>5</td>\n","      <td>9</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>6</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>4</td>\n","      <td>...</td>\n","      <td>3</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>8</td>\n","    </tr>\n","    <tr>\n","      <th>606181</th>\n","      <td>606181</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>7</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>...</td>\n","      <td>8</td>\n","      <td>4</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>2</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>6</td>\n","    </tr>\n","    <tr>\n","      <th>...</th>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","      <td>...</td>\n","    </tr>\n","    <tr>\n","      <th>576742</th>\n","      <td>576742</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>2</td>\n","      <td>9</td>\n","      <td>10</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>...</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>9</td>\n","      <td>4</td>\n","      <td>1</td>\n","      <td>8</td>\n","      <td>7</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>9</td>\n","    </tr>\n","    <tr>\n","      <th>690380</th>\n","      <td>690380</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>3</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>...</td>\n","      <td>8</td>\n","      <td>3</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>4</td>\n","    </tr>\n","    <tr>\n","      <th>309518</th>\n","      <td>309518</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>8</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>2</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>...</td>\n","      <td>7</td>\n","      <td>5</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>8</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>9</td>\n","      <td>3</td>\n","    </tr>\n","    <tr>\n","      <th>47829</th>\n","      <td>47829</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>8</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>9</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>...</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>4</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>5</td>\n","      <td>5</td>\n","    </tr>\n","    <tr>\n","      <th>721622</th>\n","      <td>721622</td>\n","      <td>4</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>3</td>\n","      <td>4</td>\n","      <td>3</td>\n","      <td>5</td>\n","      <td>...</td>\n","      <td>6</td>\n","      <td>7</td>\n","      <td>6</td>\n","      <td>9</td>\n","      <td>6</td>\n","      <td>6</td>\n","      <td>4</td>\n","      <td>5</td>\n","      <td>5</td>\n","      <td>7</td>\n","    </tr>\n","  </tbody>\n","</table>\n","<p>894365 rows × 21 columns</p>\n","</div>"],"text/plain":["            id  MonsoonIntensity  TopographyDrainage  RiverManagement  \\\n","756240  756240                 2                   5                6   \n","902933  902933                 3                   7                6   \n","393485  393485                 3                   4                3   \n","809673  809673                 2                   5                9   \n","606181  606181                 5                   6                6   \n","...        ...               ...                 ...              ...   \n","576742  576742                 4                   6                2   \n","690380  690380                 6                   6                5   \n","309518  309518                 4                   4                8   \n","47829    47829                 4                   5                8   \n","721622  721622                 4                   7                6   \n","\n","        Deforestation  Urbanization  ClimateChange  DamsQuality  Siltation  \\\n","756240              5             5              6            3          5   \n","902933              4             3              6            9          5   \n","393485              3             5              3            2          5   \n","809673              4             2              6            3          7   \n","606181              5             7              2            3          7   \n","...               ...           ...            ...          ...        ...   \n","576742              9            10              4            7          4   \n","690380              3             4              7            3          3   \n","309518              5             5              6            2          3   \n","47829               4             4              5            9          6   \n","721622              4             5              3            4          3   \n","\n","        AgriculturalPractices  ...  IneffectiveDisasterPreparedness  \\\n","756240                      5  ...                                3   \n","902933                      6  ...                                4   \n","393485                      2  ...                                8   \n","809673                      4  ...                                3   \n","606181                      6  ...                                8   \n","...                       ...  ...                              ...   \n","576742                      8  ...                                6   \n","690380                      5  ...                                8   \n","309518                      5  ...                                7   \n","47829                       4  ...                                3   \n","721622                      5  ...                                6   \n","\n","        DrainageSystems  CoastalVulnerability  Landslides  Watersheds  \\\n","756240                7                     6           8           7   \n","902933                5                     2           7           8   \n","393485                5                     4           4           7   \n","809673                6                     5           3           6   \n","606181                4                     2           3           5   \n","...                 ...                   ...         ...         ...   \n","576742                4                     9           4           1   \n","690380                3                     7           5           4   \n","309518                5                     6           7           8   \n","47829                 4                     4           4           5   \n","721622                7                     6           9           6   \n","\n","        DeterioratingInfrastructure  PopulationScore  WetlandLoss  \\\n","756240                            2                4            8   \n","902933                            7                7            5   \n","393485                            2                5            8   \n","809673                            6                7            3   \n","606181                            2                4            7   \n","...                             ...              ...          ...   \n","576742                            8                7            4   \n","690380                            5                3            4   \n","309518                            4                4            7   \n","47829                             4                6            6   \n","721622                            6                4            5   \n","\n","        InadequatePlanning  PoliticalFactors  \n","756240                   5                 4  \n","902933                   6                 3  \n","393485                   5                 4  \n","809673                   3                 8  \n","606181                   3                 6  \n","...                    ...               ...  \n","576742                   4                 9  \n","690380                   3                 4  \n","309518                   9                 3  \n","47829                    5                 5  \n","721622                   5                 7  \n","\n","[894365 rows x 21 columns]"]},"execution_count":5,"metadata":{},"output_type":"execute_result"}],"source":["X_train_original"]},{"cell_type":"code","execution_count":6,"id":"b5d43cc5","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.219622Z","iopub.status.busy":"2024-05-25T06:33:47.219221Z","iopub.status.idle":"2024-05-25T06:33:47.225374Z","shell.execute_reply":"2024-05-25T06:33:47.22405Z"},"papermill":{"duration":0.017544,"end_time":"2024-05-25T06:33:47.228739","exception":false,"start_time":"2024-05-25T06:33:47.211195","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Shape of X_train: (894365, 21)\n"]}],"source":["print(\"Shape of X_train:\", X_train.shape)"]},{"cell_type":"code","execution_count":7,"id":"a7eaefea","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.243259Z","iopub.status.busy":"2024-05-25T06:33:47.24285Z","iopub.status.idle":"2024-05-25T06:33:47.353905Z","shell.execute_reply":"2024-05-25T06:33:47.3527Z"},"papermill":{"duration":0.121929,"end_time":"2024-05-25T06:33:47.35721","exception":false,"start_time":"2024-05-25T06:33:47.235281","status":"completed"},"tags":[]},"outputs":[],"source":["from sklearn.linear_model import Ridge\n","\n","model =Ridge(alpha=1.0, fit_intercept=True, copy_X=True, max_iter=None, tol=0.001, solver='auto', random_state=None)"]},{"cell_type":"code","execution_count":8,"id":"8d199632","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.372995Z","iopub.status.busy":"2024-05-25T06:33:47.372547Z","iopub.status.idle":"2024-05-25T06:33:47.377783Z","shell.execute_reply":"2024-05-25T06:33:47.376907Z"},"papermill":{"duration":0.016732,"end_time":"2024-05-25T06:33:47.380616","exception":false,"start_time":"2024-05-25T06:33:47.363884","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["going to train model\n"]}],"source":["print('going to train model')"]},{"cell_type":"code","execution_count":9,"id":"0599876d","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.397639Z","iopub.status.busy":"2024-05-25T06:33:47.396576Z","iopub.status.idle":"2024-05-25T06:33:47.701586Z","shell.execute_reply":"2024-05-25T06:33:47.700054Z"},"papermill":{"duration":0.318605,"end_time":"2024-05-25T06:33:47.706006","exception":false,"start_time":"2024-05-25T06:33:47.387401","status":"completed"},"tags":[]},"outputs":[{"data":{"text/html":["<style>#sk-container-id-1 {color: black;background-color: white;}#sk-container-id-1 pre{padding: 0;}#sk-container-id-1 div.sk-toggleable {background-color: white;}#sk-container-id-1 label.sk-toggleable__label {cursor: pointer;display: block;width: 100%;margin-bottom: 0;padding: 0.3em;box-sizing: border-box;text-align: center;}#sk-container-id-1 label.sk-toggleable__label-arrow:before {content: \"▸\";float: left;margin-right: 0.25em;color: #696969;}#sk-container-id-1 label.sk-toggleable__label-arrow:hover:before {color: black;}#sk-container-id-1 div.sk-estimator:hover label.sk-toggleable__label-arrow:before {color: black;}#sk-container-id-1 div.sk-toggleable__content {max-height: 0;max-width: 0;overflow: hidden;text-align: left;background-color: #f0f8ff;}#sk-container-id-1 div.sk-toggleable__content pre {margin: 0.2em;color: black;border-radius: 0.25em;background-color: #f0f8ff;}#sk-container-id-1 input.sk-toggleable__control:checked~div.sk-toggleable__content {max-height: 200px;max-width: 100%;overflow: auto;}#sk-container-id-1 input.sk-toggleable__control:checked~label.sk-toggleable__label-arrow:before {content: \"▾\";}#sk-container-id-1 div.sk-estimator input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-label input.sk-toggleable__control:checked~label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 input.sk-hidden--visually {border: 0;clip: rect(1px 1px 1px 1px);clip: rect(1px, 1px, 1px, 1px);height: 1px;margin: -1px;overflow: hidden;padding: 0;position: absolute;width: 1px;}#sk-container-id-1 div.sk-estimator {font-family: monospace;background-color: #f0f8ff;border: 1px dotted black;border-radius: 0.25em;box-sizing: border-box;margin-bottom: 0.5em;}#sk-container-id-1 div.sk-estimator:hover {background-color: #d4ebff;}#sk-container-id-1 div.sk-parallel-item::after {content: \"\";width: 100%;border-bottom: 1px solid gray;flex-grow: 1;}#sk-container-id-1 div.sk-label:hover label.sk-toggleable__label {background-color: #d4ebff;}#sk-container-id-1 div.sk-serial::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: 0;}#sk-container-id-1 div.sk-serial {display: flex;flex-direction: column;align-items: center;background-color: white;padding-right: 0.2em;padding-left: 0.2em;position: relative;}#sk-container-id-1 div.sk-item {position: relative;z-index: 1;}#sk-container-id-1 div.sk-parallel {display: flex;align-items: stretch;justify-content: center;background-color: white;position: relative;}#sk-container-id-1 div.sk-item::before, #sk-container-id-1 div.sk-parallel-item::before {content: \"\";position: absolute;border-left: 1px solid gray;box-sizing: border-box;top: 0;bottom: 0;left: 50%;z-index: -1;}#sk-container-id-1 div.sk-parallel-item {display: flex;flex-direction: column;z-index: 1;position: relative;background-color: white;}#sk-container-id-1 div.sk-parallel-item:first-child::after {align-self: flex-end;width: 50%;}#sk-container-id-1 div.sk-parallel-item:last-child::after {align-self: flex-start;width: 50%;}#sk-container-id-1 div.sk-parallel-item:only-child::after {width: 0;}#sk-container-id-1 div.sk-dashed-wrapped {border: 1px dashed gray;margin: 0 0.4em 0.5em 0.4em;box-sizing: border-box;padding-bottom: 0.4em;background-color: white;}#sk-container-id-1 div.sk-label label {font-family: monospace;font-weight: bold;display: inline-block;line-height: 1.2em;}#sk-container-id-1 div.sk-label-container {text-align: center;}#sk-container-id-1 div.sk-container {/* jupyter's `normalize.less` sets `[hidden] { display: none; }` but bootstrap.min.css set `[hidden] { display: none !important; }` so we also need the `!important` here to be able to override the default hidden behavior on the sphinx rendered scikit-learn.org. See: https://github.com/scikit-learn/scikit-learn/issues/21755 */display: inline-block !important;position: relative;}#sk-container-id-1 div.sk-text-repr-fallback {display: none;}</style><div id=\"sk-container-id-1\" class=\"sk-top-container\"><div class=\"sk-text-repr-fallback\"><pre>Ridge(tol=0.001)</pre><b>In a Jupyter environment, please rerun this cell to show the HTML representation or trust the notebook. <br />On GitHub, the HTML representation is unable to render, please try loading this page with nbviewer.org.</b></div><div class=\"sk-container\" hidden><div class=\"sk-item\"><div class=\"sk-estimator sk-toggleable\"><input class=\"sk-toggleable__control sk-hidden--visually\" id=\"sk-estimator-id-1\" type=\"checkbox\" checked><label for=\"sk-estimator-id-1\" class=\"sk-toggleable__label sk-toggleable__label-arrow\">Ridge</label><div class=\"sk-toggleable__content\"><pre>Ridge(tol=0.001)</pre></div></div></div></div></div>"],"text/plain":["Ridge(tol=0.001)"]},"execution_count":9,"metadata":{},"output_type":"execute_result"}],"source":["# Reshape y_train to a 1D array\n","y_train = np.ravel(y_train)\n","\n","#training the model\n","\n","model.fit(X_train,y_train)\n","\n","\n","# Train the Neural Network model\n","#model.fit(X_train, y_train, epochs=10, batch_size=32, validation_split=0.2)"]},{"cell_type":"code","execution_count":10,"id":"bdac216d","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.738399Z","iopub.status.busy":"2024-05-25T06:33:47.737667Z","iopub.status.idle":"2024-05-25T06:33:47.797474Z","shell.execute_reply":"2024-05-25T06:33:47.795964Z"},"papermill":{"duration":0.080867,"end_time":"2024-05-25T06:33:47.801681","exception":false,"start_time":"2024-05-25T06:33:47.720814","status":"completed"},"tags":[]},"outputs":[{"name":"stdout","output_type":"stream","text":["Mean Absolute Error (MAE): 0.015798007735310947\n","Mean Squared Error (MSE): 0.0004030633791465972\n","Root Mean Squared Error (RMSE): 0.020076438407909836\n","R-squared (R²) Score: 0.8454309342282508\n"]}],"source":["# Predicting the values on the basis of sample\n","prediction=model.predict(X_test)\n","\n","# Calculate evaluation metrics\n","mae = mean_absolute_error(y_test, prediction)\n","mse = mean_squared_error(y_test, prediction)\n","rmse = mse ** 0.5\n","r2 = r2_score(y_test, prediction)\n","\n","# Print the evaluation metrics\n","print(f\"Mean Absolute Error (MAE): {mae}\")\n","print(f\"Mean Squared Error (MSE): {mse}\")\n","print(f\"Root Mean Squared Error (RMSE): {rmse}\")\n","print(f\"R-squared (R²) Score: {r2}\")\n","\n","\n","\n","# Evaluate the performance of the classifier ( this is used to identify the Accuracy of Classification Model)\n","#accuracy = accuracy_score(y_test, prediction)\n","#print(\"Accuracy:\", accuracy)\n","\n","\n","\n","# Mean Absolute Error (MAE): 0.01583093808988759\n","# Mean Squared Error (MSE): 0.00040186552736870556\n","# Root Mean Squared Error (RMSE): 0.020046583932648115\n","# R-squared (R²) Score: 0.8457744976398425\n"]},{"cell_type":"code","execution_count":11,"id":"81fb8570","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:47.834527Z","iopub.status.busy":"2024-05-25T06:33:47.833792Z","iopub.status.idle":"2024-05-25T06:33:53.665114Z","shell.execute_reply":"2024-05-25T06:33:53.66385Z"},"papermill":{"duration":5.851222,"end_time":"2024-05-25T06:33:53.668012","exception":false,"start_time":"2024-05-25T06:33:47.81679","status":"completed"},"tags":[]},"outputs":[],"source":["# Getting Column Names from Original Input dataframe and extractingn the same columns from polynomial array \n","\n","# Get feature names for the polynomial features\n","feature_names = X_test_original.columns\n","\n","# Create a DataFrame for polynomial features to easily identify the original features\n","input_df = pd.DataFrame(X_test, columns=feature_names)\n","\n","# Create a DataFrame for output data ( this dataframe will further be concatenated with Prediction so that accurace of the model could be gauged)\n","output_df = pd.DataFrame(y_test, columns=['FloodProbability'])  # Replace with appropriate column name\n","output_df.rename(columns={'FloodProbability': 'FloodProbability_test'}, inplace=True)\n","\n","# Create a DataFrame for prediction results\n","prediction_df = pd.DataFrame(prediction, columns=['FloodProbability_Predicted'])  # Assuming prediction is a 1D array\n","\n","\n","\n","#writing output in CSV for further asessment \n","\n","input_df.to_csv('/kaggle/working/input_FloodPrediction_Ridge.csv', index=False)\n","output_df.to_csv('/kaggle/working/output_FloodPrediction_Ridge.csv', index=False)\n","prediction_df.to_csv('/kaggle/working/FloodPrediction_Ridge.csv', index=False)\n","\n","\n","\n","df_input_csv= pd.read_csv('/kaggle/working/input_FloodPrediction_Ridge.csv')\n","df_output_csv= pd.read_csv('/kaggle/working/output_FloodPrediction_Ridge.csv')\n","df_prediction_csv= pd.read_csv('/kaggle/working/FloodPrediction_Ridge.csv')\n","\n","\n","\n","# Concatenate input, output, and prediction DataFrames along the columns axis\n","combined_df = pd.concat([df_input_csv, df_output_csv,df_prediction_csv], axis=1)\n","\n","\n","\n","combined_df.to_csv('/kaggle/working/FloodPrediction_final_Ridge.csv', index=False)\n","\n"]},{"cell_type":"code","execution_count":12,"id":"699f3044","metadata":{"execution":{"iopub.execute_input":"2024-05-25T06:33:53.685531Z","iopub.status.busy":"2024-05-25T06:33:53.68485Z","iopub.status.idle":"2024-05-25T06:34:13.702916Z","shell.execute_reply":"2024-05-25T06:34:13.701553Z"},"papermill":{"duration":20.030781,"end_time":"2024-05-25T06:34:13.706333","exception":false,"start_time":"2024-05-25T06:33:53.675552","status":"completed"},"tags":[]},"outputs":[],"source":["#producing Results for Submission to Kagal on Kagal provided files\n","\n","# importing CSV with training data\n","file_path = '/kaggle/input/flood-regression-dataset/test.csv'\n","\n","df22=pd.read_csv(file_path)\n","\n","df22.to_csv('/kaggle/working/Data_before_prediction_Ridge.csv', index=False)\n","\n","#defining input and output dataframes\n","Xa=df22.copy()\n","\n","\n","#predicting results\n","prediction_submission=model.predict(Xa)\n","\n","# Create a DataFrame for prediction results\n","prediction_df_final = pd.DataFrame(prediction_submission, columns=['FloodProbability'])  # Assuming prediction is a 1D array\n","\n","prediction_df_final.to_csv('/kaggle/working/output_df_results_Ridge.csv', index=False)\n","\n","\n","# Create a DataFrame for input data\n","\n","# Get feature names for the polynomial features\n","feature_names = Xa.columns\n","\n","# Create a DataFrame for polynomial features to easily identify the original features\n","input_df = pd.DataFrame(Xa, columns=feature_names)\n","\n","\n","#input_df = pd.DataFrame(Xa, columns=Xa.columns.tolist())  # Replace with appropriate column names\n","\n","input_df.to_csv('/kaggle/working/input_df_results_Ridge.csv', index=False)\n","\n","\n","df_input_csv_fin= pd.read_csv('/kaggle/working/input_df_results_Ridge.csv')\n","df_output_csv_fin= pd.read_csv('/kaggle/working/output_df_results_Ridge.csv')\n","\n","df_input_csv_fin=df_input_csv_fin[['id']]\n","# Concatenate input, output, and prediction DataFrames along the columns axis\n","combined_df_fin = pd.concat([df_input_csv_fin, df_output_csv_fin], axis=1)\n","\n","\n","combined_df_fin.to_csv('/kaggle/working/combined_df_fin_Ridge.csv', index=False)\n"]},{"cell_type":"code","execution_count":null,"id":"f9586d11","metadata":{"papermill":{"duration":0.006883,"end_time":"2024-05-25T06:34:13.720611","exception":false,"start_time":"2024-05-25T06:34:13.713728","status":"completed"},"tags":[]},"outputs":[],"source":[]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"datasetId":5080885,"sourceId":8511546,"sourceType":"datasetVersion"}],"dockerImageVersionId":30698,"isGpuEnabled":false,"isInternetEnabled":true,"language":"python","sourceType":"notebook"},"kernelspec":{"display_name":"Python 3","language":"python","name":"python3"},"language_info":{"codemirror_mode":{"name":"ipython","version":3},"file_extension":".py","mimetype":"text/x-python","name":"python","nbconvert_exporter":"python","pygments_lexer":"ipython3","version":"3.10.13"},"papermill":{"default_parameters":{},"duration":36.62955,"end_time":"2024-05-25T06:34:14.350074","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2024-05-25T06:33:37.720524","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}